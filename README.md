# GO実践入門

## HTTPリクエスト
httpはリクエスト・レスポンス型のプロトコル。
以下のような構造です。
1. リクエスト行（リクエストメソッド、URI、バージョン)
2. リクエストヘッダ（0行以上）
3. 空行
4. メッセージ本体(省略可能)

## リクエストメソッド
| メソッド名 | 概要 |
|-|-|
| GET | 指定されたリソースを返す。 |
| HEAD | メッセージ本体は返さない。レスポンスヘッダを入手したいけれども、思いメッセージ本体はネットワークに流したくない、という場合に使用。 |
| POST | メッセージ本体のデータをＵＲＩで示されたリソースに渡すように指示する。サーバーがメッセージ本体を同処理するかはサーバーに任される。 |
| PUT | メッセージ本体のデータをＵＲＩで指定されたリソースとするよう指示する。リソースがすでに存在する場合上書き、存在しない場合作成される。 |
| DELETE | URIによって指定されたリソースを削除するようサーバーに指示する。 |
| TRACE | リクエストを送り返すようサーバーに指示する。 |
| OPTIONS | サーバーがサポートするHTTPメソッドのリストを返す。 |
| CONNECT | クライアントとのネットワーク接続を準備するようにサーバーに維持する。SSLトンネリングを準備するように使用。 |
| PATCH | URIで指定されたリソースをメッセージ本体のデータにしたがって変更するようにサーバーに指示。 |

## リクエストヘッダ
HTTPリクエストの先頭行(リクエスト行)で指定されますが、リクエストに付随する情報やクライアントに関するその他の情報の多くは、2行目以降のリクエストヘッダに置かれます。リクエストヘッダは「<名前>：<値>」の形式を持つプレーンテキストであり、「CR＋LF」で終わります。

#### よく使われるリクエストヘッダ

| ヘッダフィールド | 説明 |
|-|-|
| Accept | |
| Accept-Charset | |
| Authorization | |
| Cookie | |
| Contern-Length | |
| Content-Type | |
| Host | |
| Referrer | |
| User-Agent | |

## RFC7231
HTTPリクエストヘッダに書かれるフィールドの「コアセット」はRFC7231」で標準化されています。これはHTTP1.1に関する一連のRFC(Request For Comment)の1つであり、インターネット関連技術の標準化団体であるIETFによってhっこうされる事実上の仕様書となっています。

## HTTPレスポンス
リクエストがあるたびにレスポンスが１つ返されます。以下のようなレスポンスになります。
1. ステータス行
2. 0個以上のレスポンスヘッダ
3. 空行
4. メッセージ本体(省略可能)

## レスポンスのステータスコード
HTTPレスポンスのステータスコードはそのレスポンスの種類を示すものです。
| ステータスコード | 概要 |
|-|-|
| 1XX | 情報提供。サーバーがすでにリクエストを受信しており、処理し始めている事をクライアントに伝える。 |
| 2XX | 成功。クライアントの要求が受け入れられた。サーバーはリクエストを受付、処理が成功した。このクラスの標準的なレスポンスは「200 OK」。 |
| 3XX | リダイレクション。リクエストは受け付けられて処理されたが、アクションを環椎するにはクライアントがすべきことが残っていることを示す。このクラスのステータスコードは、ほとんどがURLリダイレクション |
| 4XX | クライアントエラー。リクエストに誤りがあったことをクライアントに通知する。よく見られるのが「404 Not Found.」。このステータスは、取得しようとしたリソースが指定されたURLに見つからなかったことを示す。 |
| 5XX | サーバーエラー。リクエストの処理に失敗し、それがサーバー側の不具合によるものであることをクライアントに伝える。「500 Internal Server Error」が一般的なステータスコード。 |

#### よく使われるレスポンスヘッダ

| ヘッダフィールド | 説明 |
|-|-|
| Allow | |
| Content-Length | |
| Content-Type | |
| Date | |
| Location | |
| Server | |
| Set-Cookie | |
| WWW-Authenticate | |

## URI (Uniform Resource Identifier)
インターネット上のリソースの位置を文字列で表現する事ができる概念。
その中でリソースの名前を表す文字列であるURN(uniform resource name)と、リソースの位置を表す文字列URL(uniform resource locator)の概念があります。URIはこの両方を含む概念がありどれも類似の構文と形式を持っています。

#### URIの一般型：
```
<スキーム名>：<階層部>[?<クエリ>][#<フラグメント>]
```

#### スキーム名
URIの構造の残りの部分を定義するURIスキームの名前です。

#### 階層部
リソースを特定する情報ができますが、階層構造になっていなければなりません。
階層部が「//」で始まった場合、「@」までがオプションのユーザー情報です。階層を表すパスはその後に続きます。それ以外の場合は、階層部は単なるパスです。
パスは「/」で区切られたセグメントの列です。
必須なのは``スキーム名``と``階層部``だけです。クエリは「?」で始まり、階層表示になじまないその他の情報を含みますが、省略可能です。
#### クエリ
多くの場合は「&」で区切られた、キーと値の組になっています。

#### フラグメント
省略可能。定義されたURIの一部となる2次リソースを特定するものです。(HTMLファイル内に含まれる特定の要素を特定できます。)
フラグメントは「#」の後から始まります。URIにクエリが含まれていれば、フラグメントはクエリの後になります。フラグメントの処理はクライアントが行うことになっているので、WebブラウザはURIをサーバーに送信する前にフラグメントを除去するのが普通です。

#### HTTPスキームのURI
```
http://sausheong:password@www.example.com/docs/file?name=sausheong&location=singapore#summary
```
スキームはhttpで次に「：」が続きます。「@」までの``sausheong:password``という部分がユーザーとパスワードに関する情報です。そのあとに残りの階層部``www.example.cou/docs/file``が続きます。階層部のトップレベルはサーバーのドメイン名``www.example.com``でその後に「/」で区切られて``docs``と``file``が続きます。その次がクエリで、「?」に続く形で始まります。クエリは2つの名前と値ペア(name=sausheongとlocation=singapore)が「&」でつなげられた形になっています。最後に、クエリに続く形でフラグメントが来ます。「#」の後から始まります。


#### URLエンコーディング (パーセントエンコーディング)
URLは空白の存在は許されません。また「？」「＃」などの文字をURL内で使用したい場合URLエンコーディング(パーセントエンコーディング)を使いこのような特殊文字を別の形で表現するようにします。文字のASCIIコードを2桁の16進数で表し、その前に「%」をつけることでエンコーディングします。

# Webアプリの構成
Webアプリケーションとは以下の事をするプログラムです。
1. HTTPを開始、HTTPリクエストメッセージの形でクライアントから入力を受け取る。
1. HTTPリクエストメッセージを処理し、必要な作業を行う。
1. HTMLを生成し、HTTPレスポンスメッセージを入れて返す。

結果として、Webアプリは全く性格の異なる2つの要素から構成されることになります。
1つは「ハンドラ」で、もう1つが「テンプレートエンジン」です。

## ハンドラ
クライアントから送られてきたHTTPリクエストを受付、処理します。また、HTMLを生成する為にテンプレートエンジンを呼出し、最終的にはデータをHTTPレスポンスに組み込んで、クライアントに返送できるようにします。

## テンプレートエンジン
ここでいう「テンプレート」とはHTMLに変換できるコードであり、クライアントにHTTPレスポンスメッセージを送り返すときに利用されるものです。

### 静的テンプレート (ロジックレステンプレート)
HTMLのところどころにプレースホルダ(使用目的の決まった入力欄)となるトークンを埋め込んだものです。(例)CTemplate,Mustache

### アクティブテンプレート
HTMLを含むことも多いのですが、プレースホルダ・トークンだけでなく、条件式、繰り返し文、変数など、HTML以外のプログラミング言語の構造要素を含んでいます。
(例)JavaServer Pages(JSP), Active Server Pages(ASP), Embedded Ruby(ERB)